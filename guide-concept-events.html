<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/ef5db663/css/bootstrap.css" rel="stylesheet">
<link href="./assets/c596327a/solarized_light.css" rel="stylesheet">
<link href="./assets/956f8f39/style.css" rel="stylesheet">
<script src="./assets/2f771e29/jquery.js"></script>
<script src="./assets/ef5db663/js/bootstrap.js"></script>
<script src="./assets/b35220fb/jssearch.js"></script>    <title>Eventos - Conceptos clave - The Definitive Guide to Yii 2.0</title>
</head>
<body>

<div class="wrap">
    <nav id="w934" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w934-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./guide-index.html">The Definitive Guide to Yii 2.0</a></div><div id="w934-collapse" class="collapse navbar-collapse"><ul id="w935" class="navbar-nav nav"><li><a href="./guide-README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-918" data-toggle="collapse" data-parent="#navigation">Introducción <b class="caret"></b></a><div id="navigation-918" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-intro-yii.html">Acerca de Yii</a>
<a class="list-group-item" href="./guide-intro-upgrade-from-v1.html">Actualizar desde Yii 1.1</a></div>
<a class="list-group-item" href="#navigation-919" data-toggle="collapse" data-parent="#navigation">Primeros pasos <b class="caret"></b></a><div id="navigation-919" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-start-installation.html">Instalar Yii</a>
<a class="list-group-item" href="./guide-start-workflow.html">Funcionamiento de aplicaciones</a>
<a class="list-group-item" href="./guide-start-hello.html">Hola a todos</a>
<a class="list-group-item" href="./guide-start-forms.html">Trabajar con formularios</a>
<a class="list-group-item" href="./guide-start-databases.html">Trabajar con bases de datos</a>
<a class="list-group-item" href="./guide-start-gii.html">Generar códigos con Gii</a>
<a class="list-group-item" href="./guide-start-looking-ahead.html">Adentrarse en Yii</a></div>
<a class="list-group-item" href="#navigation-920" data-toggle="collapse" data-parent="#navigation">Estructura de una aplicación <b class="caret"></b></a><div id="navigation-920" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-structure-overview.html">Información general</a>
<a class="list-group-item" href="./guide-structure-entry-scripts.html">Script de entrada</a>
<a class="list-group-item" href="./guide-structure-applications.html">Aplicaciones</a>
<a class="list-group-item" href="./guide-structure-application-components.html">Componentes de una aplicación</a>
<a class="list-group-item" href="./guide-structure-controllers.html">Controladores</a>
<a class="list-group-item" href="./guide-structure-models.html">Modelos</a>
<a class="list-group-item" href="./guide-structure-views.html">Vistas</a>
<a class="list-group-item" href="./guide-structure-filters.html">Filtros</a>
<a class="list-group-item" href="./guide-structure-widgets.html">Widgets</a>
<a class="list-group-item" href="./guide-structure-modules.html">Módulos</a>
<a class="list-group-item" href="./guide-structure-assets.html">Assets</a>
<a class="list-group-item" href="./guide-structure-extensions.html">Extensiones</a></div>
<a class="list-group-item" href="#navigation-921" data-toggle="collapse" data-parent="#navigation">Gestión de las peticiones <b class="caret"></b></a><div id="navigation-921" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-runtime-overview.html">Información general</a>
<a class="list-group-item" href="./guide-runtime-bootstrapping.html">Bootstrapping</a>
<a class="list-group-item" href="./guide-runtime-routing.html">Routing y Creación de las URL</a>
<a class="list-group-item" href="./guide-runtime-requests.html">Peticiones (Requests)</a>
<a class="list-group-item" href="./guide-runtime-responses.html">Respuestas (Responses)</a>
<a class="list-group-item" href="./guide-runtime-sessions-cookies.html">Sesiones (Sessions) y Cookies</a>
<a class="list-group-item" href="./guide-runtime-handling-errors.html">Gestión de errores</a>
<a class="list-group-item" href="./guide-runtime-logging.html">Registro de anotaciones</a></div>
<a class="list-group-item active" href="#navigation-922" data-toggle="collapse" data-parent="#navigation">Conceptos clave <b class="caret"></b></a><div id="navigation-922" class="submenu panel-collapse collapse in"><a class="list-group-item" href="./guide-concept-components.html">Componentes</a>
<a class="list-group-item" href="./guide-concept-properties.html">Propiedades</a>
<a class="list-group-item active" href="./guide-concept-events.html">Eventos</a>
<a class="list-group-item" href="./guide-concept-behaviors.html">Comportamientos (Behaviors)</a>
<a class="list-group-item" href="./guide-concept-configurations.html">Configuraciones</a>
<a class="list-group-item" href="./guide-concept-aliases.html">Alias</a>
<a class="list-group-item" href="./guide-concept-autoloading.html">Autocarga de clases</a>
<a class="list-group-item" href="./guide-concept-service-locator.html">Localizador de servicios (Service Locator)</a>
<a class="list-group-item" href="./guide-concept-di-container.html">Contenedor de inyección de dependencia</a></div>
<a class="list-group-item" href="#navigation-923" data-toggle="collapse" data-parent="#navigation">Trabajar con bases de datos <b class="caret"></b></a><div id="navigation-923" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-db-dao.html">Objeto de acceso a datos</a>
<a class="list-group-item" href="./guide-db-query-builder.html">Constructor de consultas</a>
<a class="list-group-item" href="./guide-db-active-record.html">Active Record</a>
<a class="list-group-item" href="./guide-db-migrations.html">Migraciones</a>
<a class="list-group-item" href="./guide-db-sphinx.html">Sphinx</a>
<a class="list-group-item" href="./guide-db-redis.html">Redis</a>
<a class="list-group-item" href="./guide-db-mongodb.html">MongoDB</a>
<a class="list-group-item" href="./guide-db-elastic-search.html">ElasticSearch</a></div>
<a class="list-group-item" href="#navigation-924" data-toggle="collapse" data-parent="#navigation">Obtener datos de los usuarios <b class="caret"></b></a><div id="navigation-924" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-input-forms.html">Crear formularios</a>
<a class="list-group-item" href="./guide-input-validation.html">Validar datos</a>
<a class="list-group-item" href="./guide-input-file-upload.html">Subir archivos</a>
<a class="list-group-item" href="./guide-input-tabular-input.html">Recogida de tabular input</a>
<a class="list-group-item" href="./guide-input-multiple-models.html">Obtener datos para múltiples modelos</a></div>
<a class="list-group-item" href="#navigation-925" data-toggle="collapse" data-parent="#navigation">Visualizar datos <b class="caret"></b></a><div id="navigation-925" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-output-formatting.html">Formato de datos</a>
<a class="list-group-item" href="./guide-output-pagination.html">Paginación</a>
<a class="list-group-item" href="./guide-output-sorting.html">Ordenación</a>
<a class="list-group-item" href="./guide-output-data-providers.html">Proveedores de datos</a>
<a class="list-group-item" href="./guide-output-data-widgets.html">Widgets de datos</a>
<a class="list-group-item" href="./guide-output-client-scripts.html">Trabajar con scripts de cliente</a>
<a class="list-group-item" href="./guide-output-theming.html">Temas</a></div>
<a class="list-group-item" href="#navigation-926" data-toggle="collapse" data-parent="#navigation">Seguridad <b class="caret"></b></a><div id="navigation-926" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-security-authentication.html">Autenticación</a>
<a class="list-group-item" href="./guide-security-authorization.html">Autorización</a>
<a class="list-group-item" href="./guide-security-passwords.html">Trabajar con contraseñas</a>
<a class="list-group-item" href="./guide-security-auth-clients.html">Autenticar Clientes</a>
<a class="list-group-item" href="./guide-security-best-practices.html">Buenas prácticas</a></div>
<a class="list-group-item" href="#navigation-927" data-toggle="collapse" data-parent="#navigation">Caché <b class="caret"></b></a><div id="navigation-927" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-caching-overview.html">Información general</a>
<a class="list-group-item" href="./guide-caching-data.html">Caché de datos</a>
<a class="list-group-item" href="./guide-caching-fragment.html">Caché de fragmentos</a>
<a class="list-group-item" href="./guide-caching-page.html">Caché de páginas</a>
<a class="list-group-item" href="./guide-caching-http.html">Caché HTTP</a></div>
<a class="list-group-item" href="#navigation-928" data-toggle="collapse" data-parent="#navigation">Servicios Web RESTful <b class="caret"></b></a><div id="navigation-928" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-rest-quick-start.html">Guía breve</a>
<a class="list-group-item" href="./guide-rest-resources.html">Recursos (Resources)</a>
<a class="list-group-item" href="./guide-rest-controllers.html">Controladores</a>
<a class="list-group-item" href="./guide-rest-routing.html">Gestión de rutas</a>
<a class="list-group-item" href="./guide-rest-response-formatting.html">Formateo de respuestas</a>
<a class="list-group-item" href="./guide-rest-authentication.html">Autenticación</a>
<a class="list-group-item" href="./guide-rest-rate-limiting.html">Límite de Rango</a>
<a class="list-group-item" href="./guide-rest-versioning.html">Gestión de versiones</a>
<a class="list-group-item" href="./guide-rest-error-handling.html">Gestión de errores</a></div>
<a class="list-group-item" href="#navigation-929" data-toggle="collapse" data-parent="#navigation">Herramientas de Desarrollo <b class="caret"></b></a><div id="navigation-929" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/yiisoft/yii2-debug/blob/master/docs/guide-es/README.md">Depurador y Barra de Herramientas de Depuración</a>
<a class="list-group-item" href="./guide-tool-gii.html">Generación de códigos con Gii</a>
<a class="list-group-item" href="./guide-tool-api-doc.html">Generación de documentación de API</a></div>
<a class="list-group-item" href="#navigation-930" data-toggle="collapse" data-parent="#navigation">Pruebas <b class="caret"></b></a><div id="navigation-930" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-test-overview.html">Información general</a>
<a class="list-group-item" href="./guide-test-environment-setup.html">Configuración del entorno de pruebas</a>
<a class="list-group-item" href="./guide-test-unit.html">Pruebas unitarias</a>
<a class="list-group-item" href="./guide-test-functional.html">Pruebas funcionales</a>
<a class="list-group-item" href="./guide-test-acceptance.html">Pruebas de aceptación</a>
<a class="list-group-item" href="./guide-test-fixtures.html">Fixtures</a></div>
<a class="list-group-item" href="#navigation-931" data-toggle="collapse" data-parent="#navigation">Temas especiales <b class="caret"></b></a><div id="navigation-931" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-tutorial-advanced-app.html">Plantilla aplicación avanzada</a>
<a class="list-group-item" href="./guide-tutorial-start-from-scratch.html">Creación de una aplicación desde cero</a>
<a class="list-group-item" href="./guide-tutorial-console.html">Comandos de consola</a>
<a class="list-group-item" href="./guide-tutorial-core-validators.html">Validadores del núcleo</a>
<a class="list-group-item" href="./guide-tutorial-i18n.html">Internacionalización</a>
<a class="list-group-item" href="./guide-tutorial-mailing.html">Envío de correos electrónicos</a>
<a class="list-group-item" href="./guide-tutorial-performance-tuning.html">Mejora del rendimiento</a>
<a class="list-group-item" href="./guide-tutorial-shared-hosting.html">Entorno de alojamiento compartido</a>
<a class="list-group-item" href="./guide-tutorial-template-engines.html">Motores de plantillas</a>
<a class="list-group-item" href="./guide-tutorial-yii-integration.html">Trabajar con Código de Terceros</a></div>
<a class="list-group-item" href="#navigation-932" data-toggle="collapse" data-parent="#navigation">Widgets <b class="caret"></b></a><div id="navigation-932" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/yiisoft/yii2-bootstrap/blob/master/docs/guide-es/README.md">Bootstrap Widgets</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-jui/blob/master/docs/guide-es/README.md">Jquery UI Widgets</a></div>
<a class="list-group-item" href="#navigation-933" data-toggle="collapse" data-parent="#navigation">Clases auxiliares <b class="caret"></b></a><div id="navigation-933" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-helper-overview.html">Información general</a>
<a class="list-group-item" href="./guide-helper-array.html">ArrayHelper</a>
<a class="list-group-item" href="./guide-helper-html.html">Html</a>
<a class="list-group-item" href="./guide-helper-url.html">Url</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>Eventos <span id="eventos"></span><a href="#eventos" class="hashlink">&para;</a></h1>
<div class="toc"><ol><li><a href="#event-handlers">Gestor de Eventos</a></li>
<li><a href="#attaching-event-handlers">Añadir Gestores de Eventos</a></li>
<li><a href="#ordenacion-de-gestores-de-eventos">Ordenación de Gestores de Eventos</a></li>
<li><a href="#triggering-events">Lanzamiento de Eventos</a></li>
<li><a href="#detaching-event-handlers">Desadjuntar Gestores de Evento</a></li>
<li><a href="#class-level-event-handlers">Nivel de Clase (Class-Level) Gestores de Eventos</a></li>
<li><a href="#global-events">Eventos Globales</a></li></ol></div>
<p>Los eventos permiten inyectar código dentro de otro código existente en ciertos puntos de ejecución. Se pueden adjuntar
código personalizado a un evento, cuando se lance (triggered), el código se ejecutará automáticamente. Por ejemplo, un
objeto mailer puede lanzar el evento <code>messageSent</code> cuando se envía un mensaje correctamente. Si se quiere rastrear
el correcto envío del mensaje, se puede, simplemente, añadir un código de seguimiento al evento <code>messageSent</code>.</p>
<p>Yii introduce una clase base <span class="broken-link">yii\base\Component</span> para soportar eventos. Si una clase necesita lanzar un evento,
este debe extender a <span class="broken-link">yii\base\Component</span> o a una clase hija.</p>
<h2>Gestor de Eventos  <span id="event-handlers"></span><a href="#event-handlers" class="hashlink">&para;</a></h2><p>Un gestor de eventos es una
<a href="http://php.net/manual/es/language.types.callable.php">llamada de retorno PHP (PHP callback)</a> que se ejecuta cuando se
lanza el evento al que corresponde. Se puede usar cualquier llamada de retorno de las enumeradas a continuación:</p>
<ul>
<li>una función de PHP global especificada como una cadena de texto (sin paréntesis), ej. <code>'trim'</code>;</li>
<li>un método de objeto especificado como un array de un objeto y un nombre de método como una cadena de texto
(sin paréntesis), ej. <code>[$object, 'methodNAme']</code>;</li>
<li>un método de clase estático especificado como un array de un nombre de clase y un método como una cadena de texto
(sin paréntesis), ej. <code>[$class, 'methodName']</code>;</li>
<li>una función anónima, ej. <code>function ($event) { ... }</code>.</li>
</ul>
<p>La firma de un gestor de eventos es:</p>
<pre><code class="hljs php language-php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$event</span>)</span> </span>{
    <span class="hljs-comment">// $event es un objeto de yii\base\Event o de una clase hija</span>
}
</code></pre>
<p>Un gestor de eventos puede obtener la siguiente información acerca de un evento ya sucedido mediante el parámetro
<code>$event</code>:</p>
<ul>
<li><span class="broken-link">yii\base\Event::name</span></li>
<li><span class="broken-link">yii\base\Event::sender</span>: el objeto desde el que se ha ejecutado <code>trigger()</code></li>
<li><span class="broken-link">yii\base\Event::data</span>: los datos que se proporcionan al adjuntar el gestor de eventos
(se explicará más adelante)</li>
</ul>
<h2>Añadir Gestores de Eventos  <span id="attaching-event-handlers"></span><a href="#attaching-event-handlers" class="hashlink">&para;</a></h2><p>Se puede añadir un gestor a un evento llamando al método <span class="broken-link">yii\base\Component::on()</span>. Por ejemplo:</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$foo</span> = <span class="hljs-keyword">new</span> Foo;

<span class="hljs-comment">// este gestor es una función global</span>
<span class="hljs-variable">$foo</span>-&gt;on(Foo::EVENT_HELLO, <span class="hljs-string">'function_name'</span>);

<span class="hljs-comment">// este gestor es un método de objeto</span>
<span class="hljs-variable">$foo</span>-&gt;on(Foo::EVENT_HELLO, [<span class="hljs-variable">$object</span>, <span class="hljs-string">'methodName'</span>]);

<span class="hljs-comment">// este gestor es un método de clase estática</span>
<span class="hljs-variable">$foo</span>-&gt;on(Foo::EVENT_HELLO, [<span class="hljs-string">'app\components\Bar'</span>, <span class="hljs-string">'methodName'</span>]);

<span class="hljs-comment">// este gestor es una función anónima</span>
<span class="hljs-variable">$foo</span>-&gt;on(Foo::EVENT_HELLO, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$event</span>)</span> </span>{
    <span class="hljs-comment">// event handling logic</span>
});
</code></pre>
<p>También se pueden adjuntar gestores de eventos mediante <a href="guide-concept-configurations.html">configuraciones</a>. Se pueden
encontrar más de talles en la sección <a href="guide-concept-configurations.html#configuration-format">Configuraciones</a>.</p>
<p>Cuando se adjunta un gestor de eventos, se pueden proporcionar datos adicionales como tercer parámetro de
<span class="broken-link">yii\base\Component::on()</span>. El gestor podrá acceder a los datos cuando se lance el evento y se ejecute el gestor.
Por ejemplo:</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// El siguiente código muestra "abc" cuando se lanza el evento</span>
<span class="hljs-comment">// ya que $event-&gt;data contiene los datos enviados en el tercer parámetro de "on"</span>
<span class="hljs-variable">$foo</span>-&gt;on(Foo::EVENT_HELLO, <span class="hljs-string">'function_name'</span>, <span class="hljs-string">'abc'</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">function_name</span><span class="hljs-params">(<span class="hljs-variable">$event</span>)</span> </span>{
    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$event</span>-&gt;data;
}
</code></pre>
<h2>Ordenación de Gestores de Eventos <span id="ordenacion-de-gestores-de-eventos"></span><a href="#ordenacion-de-gestores-de-eventos" class="hashlink">&para;</a></h2><p>Se puede adjuntar uno o más gestores a un único evento. Cuando se lanza un evento, se ejecutarán los gestores adjuntos
en el orden que se hayan añadido al evento. Si un gestor necesita parar la invocación de los gestores que le siguen,
se puede establecer la propiedad <span class="broken-link">yii\base\Event::handled</span> del parámetro <code>$event</code> para que sea <code>true</code>:</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$foo</span>-&gt;on(Foo::EVENT_HELLO, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$event</span>)</span> </span>{
    <span class="hljs-variable">$event</span>-&gt;handled = <span class="hljs-keyword">true</span>;
});
</code></pre>
<p>De forma predeterminada, cada nuevo gestor añadido se pone a la cola de la lista de gestores del evento. Por lo tanto,
el gestor se ejecutará en el último lugar cuando se lance el evento. Para insertar un nuevo gestor al principio de la
cola de gestores para que sea ejecutado primero, se debe llamar a <span class="broken-link">yii\base\Component::on()</span>, pasando al cuarto
parámetro <code>$append</code> el valor <code>false</code>:</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$foo</span>-&gt;on(Foo::EVENT_HELLO, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$event</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>
}, <span class="hljs-variable">$data</span>, <span class="hljs-keyword">false</span>);
</code></pre>
<h2>Lanzamiento de Eventos  <span id="triggering-events"></span><a href="#triggering-events" class="hashlink">&para;</a></h2><p>Los eventos se lanzan llamando al método <span class="broken-link">yii\base\Component::trigger()</span>. El método requiere un <em>nombre de evento</em>,
y de forma opcional un objeto de evento que describa los parámetros que se enviarán a los gestores de eventos. Por
ejemplo:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Component</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Event</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span>
</span>{
    <span class="hljs-keyword">const</span> EVENT_HELLO = <span class="hljs-string">'hello'</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bar</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;trigger(<span class="hljs-keyword">self</span>::EVENT_HELLO);
    }
}
</code></pre>
<p>Con el código anterior, cada llamada a <code>bar()</code> lanzará un evento llamado <code>hello</code></p>
<blockquote class="tip"><p><strong>Tip: </strong>Se recomienda usar las constantes de clase para representar nombres de eventos. En el anterior ejemplo, la
  constante <code>EVENT_HELLO</code> representa el evento <code>hello</code>. Este enfoque proporciona tres beneficios. Primero, previene
  errores tipográficos. Segundo, puede hacer que los IDEs reconozcan los eventos en las funciones de auto-completado.
  Tercero, se puede ver que eventos soporta una clase simplemente revisando la declaración de constantes.</p>
</blockquote>
<p>A veces cuando se lanza un evento se puede querer pasar información adicional al gestor de eventos. Por ejemplo, un
mailer puede querer enviar la información del mensaje para que los gestores del evento <code>messageSent</code> para que los
gestores puedan saber las particularidades del mensaje enviado. Para hacerlo, se puede proporcionar un objeto de tipo
evento como segundo parámetro al método <span class="broken-link">yii\base\Component::trigger()</span>. El objeto de tipo evento debe ser una
instancia de la clase <span class="broken-link">yii\base\Event</span> o de su clase hija. Por ejemplo:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Component</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Event</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MessageEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Event</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$message</span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mailer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span>
</span>{
    <span class="hljs-keyword">const</span> EVENT_MESSAGE_SENT = <span class="hljs-string">'messageSent'</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">send</span><span class="hljs-params">(<span class="hljs-variable">$message</span>)</span>
    </span>{
        <span class="hljs-comment">// ...enviando $message...</span>

        <span class="hljs-variable">$event</span> = <span class="hljs-keyword">new</span> MessageEvent;
        <span class="hljs-variable">$event</span>-&gt;message = <span class="hljs-variable">$message</span>;
        <span class="hljs-variable">$this</span>-&gt;trigger(<span class="hljs-keyword">self</span>::EVENT_MESSAGE_SENT, <span class="hljs-variable">$event</span>);
    }
}
</code></pre>
<p>Cuando se lanza el método <span class="broken-link">yii\base\Component::trigger()</span>, se ejecutarán todos los gestores adjuntos al evento.</p>
<h2>Desadjuntar Gestores de Evento  <span id="detaching-event-handlers"></span><a href="#detaching-event-handlers" class="hashlink">&para;</a></h2><p>Para desadjuntar un gestor de un evento, se puede ejecutar el método <span class="broken-link">yii\base\Component::off()</span>. Por ejemplo:</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// el gestor es una función global</span>
<span class="hljs-variable">$foo</span>-&gt;off(Foo::EVENT_HELLO, <span class="hljs-string">'function_name'</span>);

<span class="hljs-comment">// el gestor es un método de objeto</span>
<span class="hljs-variable">$foo</span>-&gt;off(Foo::EVENT_HELLO, [<span class="hljs-variable">$object</span>, <span class="hljs-string">'methodName'</span>]);

<span class="hljs-comment">// el gestor es un método estático de clase</span>
<span class="hljs-variable">$foo</span>-&gt;off(Foo::EVENT_HELLO, [<span class="hljs-string">'app\components\Bar'</span>, <span class="hljs-string">'methodName'</span>]);

<span class="hljs-comment">// el gestor es una función anónima</span>
<span class="hljs-variable">$foo</span>-&gt;off(Foo::EVENT_HELLO, <span class="hljs-variable">$anonymousFunction</span>);
</code></pre>
<p>Tenga en cuenta que en general no se debe intentar desadjuntar las funciones anónimas a no ser que se almacene donde
se ha adjuntado al evento. En el anterior ejemplo, se asume que la función anónima se almacena como variable
<code>$anonymousFunction</code>.</p>
<p>Para desadjuntar TODOS los gestores de un evento, se puede llamar <span class="broken-link">yii\base\Component::off()</span> sin el segundo
parámetro:</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$foo</span>-&gt;off(Foo::EVENT_HELLO);
</code></pre>
<h2>Nivel de Clase (Class-Level) Gestores de Eventos  <span id="class-level-event-handlers"></span><a href="#class-level-event-handlers" class="hashlink">&para;</a></h2><p>En las subsecciones anteriores se ha descrito como adjuntar un gestor a un evento a <em>nivel de instancia</em>. A veces, se
puede querer que un gestor responda todos los eventos de <em>todos</em> las instancias de una clase en lugar de una instancia
especifica. En lugar de adjuntar un gestor de eventos a una instancia, se puede adjuntar un gestor a <em>nivel de clase</em>
llamando al método estático <span class="broken-link">yii\base\Event::on()</span>.</p>
<p>Por ejemplo, un objeto de tipo <a href="guide-db-active-record.html">Active Record</a> lanzará un evento
<span class="broken-link">yii\db\BaseActiveRecord::EVENT_AFTER_INSERT</span> cada vez que inserte un nuevo registro en la base
de datos. Para poder registrar las inserciones efectuadas por <em>todos</em> los objetos
<a href="guide-db-active-record.html">Active Record</a>, se puede usar el siguiente código:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Yii</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Event</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">db</span>\<span class="hljs-title">ActiveRecord</span>;

Event::on(ActiveRecord::className(), ActiveRecord::EVENT_AFTER_INSERT, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$event</span>)</span> </span>{
    Yii::trace(get_class(<span class="hljs-variable">$event</span>-&gt;sender) . <span class="hljs-string">' is inserted'</span>);
});
</code></pre>
<p>Se invocará al gestor de eventos cada vez que una instancia de <span class="broken-link">yii\db\ActiveRecord</span>, o de uno de sus
clases hijas, lance un evento de tipo <span class="broken-link">yii\db\BaseActiveRecord::EVENT_AFTER_INSERT</span>. Se puede
obtener el objeto que ha lanzado el evento mediante <code>$event-&gt;sender</code> en el gestor.</p>
<p>Cuando un objeto lanza un evento, primero llamará los gestores a nivel de instancia, y a continuación los gestores a
nivel de clase.</p>
<p>Se puede lanzar un evento de tipo <em>nivel de clase</em> llamando al método estático <span class="broken-link">yii\base\Event::trigger()</span>. Un
evento de nivel de clase no se asocia a un objeto en particular. Como resultado, esto provocará solamente la
invocación de los gestores de eventos a nivel de clase.</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Event</span>;

Event::on(Foo::className(), Foo::EVENT_HELLO, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$event</span>)</span> </span>{
    var_dump(<span class="hljs-variable">$event</span>-&gt;sender);  <span class="hljs-comment">// displays "null"</span>
});

Event::trigger(Foo::className(), Foo::EVENT_HELLO);
</code></pre>
<p>Tenga en cuenta que en este caso, el <code>$event-&gt;sender</code> hace referencia al nombre de la clase que lanza el evento en
lugar de a la instancia del objeto.</p>
<blockquote class="note"><p><strong>Note: </strong>Debido a que los gestores a nivel de clase responderán a los eventos lanzados por cualquier instancia de la
clase, o cualquier clase hija, se debe usar con cuidado, especialmente en las clases de bajo nivel (low-level), tales
como <span class="broken-link">yii\base\Object</span>.</p>
</blockquote>
<p>Para desadjuntar un gestor de eventos a nivel de clase, se tiene que llamar a <span class="broken-link">yii\base\Event::off()</span>. Por ejemplo:</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// desadjunta $handler</span>
Event::off(Foo::className(), Foo::EVENT_HELLO, <span class="hljs-variable">$handler</span>);

<span class="hljs-comment">// desadjunta todos los gestores de Foo::EVENT_HELLO</span>
Event::off(Foo::className(), Foo::EVENT_HELLO);
</code></pre>
<h2>Eventos Globales  <span id="global-events"></span><a href="#global-events" class="hashlink">&para;</a></h2><p>Yii soporta los llamados <em>eventos globales</em>, que en realidad es un truco basado en el gestor de eventos descrito
anteriormente. El evento global requiere un Singleton globalmente accesible, tal como la instancia de
<a href="guide-structure-applications.html">aplicación</a> en si misma.</p>
<p>Para crear un evento global, un evento remitente (event sender) llama al método <code>trigger()</code> del Singleton para lanzar
el evento, en lugar de llamar al propio método <code>trigger()</code> del remitente. De forma similar, los gestores de eventos se
adjuntan al evento del Singleton. Por ejemplo:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Yii</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Event</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>\<span class="hljs-title">Foo</span>;

Yii::<span class="hljs-variable">$app</span>-&gt;on(<span class="hljs-string">'bar'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$event</span>)</span> </span>{
    <span class="hljs-keyword">echo</span> get_class(<span class="hljs-variable">$event</span>-&gt;sender);  <span class="hljs-comment">// muestra "app\components\Foo"</span>
});

Yii::<span class="hljs-variable">$app</span>-&gt;trigger(<span class="hljs-string">'bar'</span>, <span class="hljs-keyword">new</span> Event([<span class="hljs-string">'sender'</span> =&gt; <span class="hljs-keyword">new</span> Foo]));
</code></pre>
<p>Un beneficio de usar eventos globales es que no se necesita un objeto cuando se adjuntan gestores a un evento para que
sean lanzados por el objeto. En su lugar, los gestores adjuntos y el lanzamiento de eventos se efectúan en el
Singleton (ej. la instancia de la aplicación).</p>
<p>Sin embargo, debido a que los <code>namespaces</code> de los eventos globales son compartidos por todas partes, se les deben
asignar nombres bien pensados, como puede ser la introducción de algún <code>namespace</code>
(ej. "frontend.mail.sent", "backend.mail.sent").</p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Wed, 22 Mar 2017 18:28:18 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) setTimeout(shiftWindow, 1);
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
