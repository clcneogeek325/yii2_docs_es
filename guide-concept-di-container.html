<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/ef5db663/css/bootstrap.css" rel="stylesheet">
<link href="./assets/c596327a/solarized_light.css" rel="stylesheet">
<link href="./assets/956f8f39/style.css" rel="stylesheet">
<script src="./assets/2f771e29/jquery.js"></script>
<script src="./assets/ef5db663/js/bootstrap.js"></script>
<script src="./assets/b35220fb/jssearch.js"></script>    <title>Contenedor de inyección de dependencia - Conceptos clave - The Definitive Guide to Yii 2.0</title>
</head>
<body>

<div class="wrap">
    <nav id="w232" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w232-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./guide-index.html">The Definitive Guide to Yii 2.0</a></div><div id="w232-collapse" class="collapse navbar-collapse"><ul id="w233" class="navbar-nav nav"><li><a href="./guide-README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-216" data-toggle="collapse" data-parent="#navigation">Introducción <b class="caret"></b></a><div id="navigation-216" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-intro-yii.html">Acerca de Yii</a>
<a class="list-group-item" href="./guide-intro-upgrade-from-v1.html">Actualizar desde Yii 1.1</a></div>
<a class="list-group-item" href="#navigation-217" data-toggle="collapse" data-parent="#navigation">Primeros pasos <b class="caret"></b></a><div id="navigation-217" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-start-installation.html">Instalar Yii</a>
<a class="list-group-item" href="./guide-start-workflow.html">Funcionamiento de aplicaciones</a>
<a class="list-group-item" href="./guide-start-hello.html">Hola a todos</a>
<a class="list-group-item" href="./guide-start-forms.html">Trabajar con formularios</a>
<a class="list-group-item" href="./guide-start-databases.html">Trabajar con bases de datos</a>
<a class="list-group-item" href="./guide-start-gii.html">Generar códigos con Gii</a>
<a class="list-group-item" href="./guide-start-looking-ahead.html">Adentrarse en Yii</a></div>
<a class="list-group-item" href="#navigation-218" data-toggle="collapse" data-parent="#navigation">Estructura de una aplicación <b class="caret"></b></a><div id="navigation-218" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-structure-overview.html">Información general</a>
<a class="list-group-item" href="./guide-structure-entry-scripts.html">Script de entrada</a>
<a class="list-group-item" href="./guide-structure-applications.html">Aplicaciones</a>
<a class="list-group-item" href="./guide-structure-application-components.html">Componentes de una aplicación</a>
<a class="list-group-item" href="./guide-structure-controllers.html">Controladores</a>
<a class="list-group-item" href="./guide-structure-models.html">Modelos</a>
<a class="list-group-item" href="./guide-structure-views.html">Vistas</a>
<a class="list-group-item" href="./guide-structure-filters.html">Filtros</a>
<a class="list-group-item" href="./guide-structure-widgets.html">Widgets</a>
<a class="list-group-item" href="./guide-structure-modules.html">Módulos</a>
<a class="list-group-item" href="./guide-structure-assets.html">Assets</a>
<a class="list-group-item" href="./guide-structure-extensions.html">Extensiones</a></div>
<a class="list-group-item" href="#navigation-219" data-toggle="collapse" data-parent="#navigation">Gestión de las peticiones <b class="caret"></b></a><div id="navigation-219" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-runtime-overview.html">Información general</a>
<a class="list-group-item" href="./guide-runtime-bootstrapping.html">Bootstrapping</a>
<a class="list-group-item" href="./guide-runtime-routing.html">Routing y Creación de las URL</a>
<a class="list-group-item" href="./guide-runtime-requests.html">Peticiones (Requests)</a>
<a class="list-group-item" href="./guide-runtime-responses.html">Respuestas (Responses)</a>
<a class="list-group-item" href="./guide-runtime-sessions-cookies.html">Sesiones (Sessions) y Cookies</a>
<a class="list-group-item" href="./guide-runtime-handling-errors.html">Gestión de errores</a>
<a class="list-group-item" href="./guide-runtime-logging.html">Registro de anotaciones</a></div>
<a class="list-group-item active" href="#navigation-220" data-toggle="collapse" data-parent="#navigation">Conceptos clave <b class="caret"></b></a><div id="navigation-220" class="submenu panel-collapse collapse in"><a class="list-group-item" href="./guide-concept-components.html">Componentes</a>
<a class="list-group-item" href="./guide-concept-properties.html">Propiedades</a>
<a class="list-group-item" href="./guide-concept-events.html">Eventos</a>
<a class="list-group-item" href="./guide-concept-behaviors.html">Comportamientos (Behaviors)</a>
<a class="list-group-item" href="./guide-concept-configurations.html">Configuraciones</a>
<a class="list-group-item" href="./guide-concept-aliases.html">Alias</a>
<a class="list-group-item" href="./guide-concept-autoloading.html">Autocarga de clases</a>
<a class="list-group-item" href="./guide-concept-service-locator.html">Localizador de servicios (Service Locator)</a>
<a class="list-group-item active" href="./guide-concept-di-container.html">Contenedor de inyección de dependencia</a></div>
<a class="list-group-item" href="#navigation-221" data-toggle="collapse" data-parent="#navigation">Trabajar con bases de datos <b class="caret"></b></a><div id="navigation-221" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-db-dao.html">Objeto de acceso a datos</a>
<a class="list-group-item" href="./guide-db-query-builder.html">Constructor de consultas</a>
<a class="list-group-item" href="./guide-db-active-record.html">Active Record</a>
<a class="list-group-item" href="./guide-db-migrations.html">Migraciones</a>
<a class="list-group-item" href="./guide-db-sphinx.html">Sphinx</a>
<a class="list-group-item" href="./guide-db-redis.html">Redis</a>
<a class="list-group-item" href="./guide-db-mongodb.html">MongoDB</a>
<a class="list-group-item" href="./guide-db-elastic-search.html">ElasticSearch</a></div>
<a class="list-group-item" href="#navigation-222" data-toggle="collapse" data-parent="#navigation">Obtener datos de los usuarios <b class="caret"></b></a><div id="navigation-222" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-input-forms.html">Crear formularios</a>
<a class="list-group-item" href="./guide-input-validation.html">Validar datos</a>
<a class="list-group-item" href="./guide-input-file-upload.html">Subir archivos</a>
<a class="list-group-item" href="./guide-input-tabular-input.html">Recogida de tabular input</a>
<a class="list-group-item" href="./guide-input-multiple-models.html">Obtener datos para múltiples modelos</a></div>
<a class="list-group-item" href="#navigation-223" data-toggle="collapse" data-parent="#navigation">Visualizar datos <b class="caret"></b></a><div id="navigation-223" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-output-formatting.html">Formato de datos</a>
<a class="list-group-item" href="./guide-output-pagination.html">Paginación</a>
<a class="list-group-item" href="./guide-output-sorting.html">Ordenación</a>
<a class="list-group-item" href="./guide-output-data-providers.html">Proveedores de datos</a>
<a class="list-group-item" href="./guide-output-data-widgets.html">Widgets de datos</a>
<a class="list-group-item" href="./guide-output-client-scripts.html">Trabajar con scripts de cliente</a>
<a class="list-group-item" href="./guide-output-theming.html">Temas</a></div>
<a class="list-group-item" href="#navigation-224" data-toggle="collapse" data-parent="#navigation">Seguridad <b class="caret"></b></a><div id="navigation-224" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-security-authentication.html">Autenticación</a>
<a class="list-group-item" href="./guide-security-authorization.html">Autorización</a>
<a class="list-group-item" href="./guide-security-passwords.html">Trabajar con contraseñas</a>
<a class="list-group-item" href="./guide-security-auth-clients.html">Autenticar Clientes</a>
<a class="list-group-item" href="./guide-security-best-practices.html">Buenas prácticas</a></div>
<a class="list-group-item" href="#navigation-225" data-toggle="collapse" data-parent="#navigation">Caché <b class="caret"></b></a><div id="navigation-225" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-caching-overview.html">Información general</a>
<a class="list-group-item" href="./guide-caching-data.html">Caché de datos</a>
<a class="list-group-item" href="./guide-caching-fragment.html">Caché de fragmentos</a>
<a class="list-group-item" href="./guide-caching-page.html">Caché de páginas</a>
<a class="list-group-item" href="./guide-caching-http.html">Caché HTTP</a></div>
<a class="list-group-item" href="#navigation-226" data-toggle="collapse" data-parent="#navigation">Servicios Web RESTful <b class="caret"></b></a><div id="navigation-226" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-rest-quick-start.html">Guía breve</a>
<a class="list-group-item" href="./guide-rest-resources.html">Recursos (Resources)</a>
<a class="list-group-item" href="./guide-rest-controllers.html">Controladores</a>
<a class="list-group-item" href="./guide-rest-routing.html">Gestión de rutas</a>
<a class="list-group-item" href="./guide-rest-response-formatting.html">Formateo de respuestas</a>
<a class="list-group-item" href="./guide-rest-authentication.html">Autenticación</a>
<a class="list-group-item" href="./guide-rest-rate-limiting.html">Límite de Rango</a>
<a class="list-group-item" href="./guide-rest-versioning.html">Gestión de versiones</a>
<a class="list-group-item" href="./guide-rest-error-handling.html">Gestión de errores</a></div>
<a class="list-group-item" href="#navigation-227" data-toggle="collapse" data-parent="#navigation">Herramientas de Desarrollo <b class="caret"></b></a><div id="navigation-227" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/yiisoft/yii2-debug/blob/master/docs/guide-es/README.md">Depurador y Barra de Herramientas de Depuración</a>
<a class="list-group-item" href="./guide-tool-gii.html">Generación de códigos con Gii</a>
<a class="list-group-item" href="./guide-tool-api-doc.html">Generación de documentación de API</a></div>
<a class="list-group-item" href="#navigation-228" data-toggle="collapse" data-parent="#navigation">Pruebas <b class="caret"></b></a><div id="navigation-228" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-test-overview.html">Información general</a>
<a class="list-group-item" href="./guide-test-environment-setup.html">Configuración del entorno de pruebas</a>
<a class="list-group-item" href="./guide-test-unit.html">Pruebas unitarias</a>
<a class="list-group-item" href="./guide-test-functional.html">Pruebas funcionales</a>
<a class="list-group-item" href="./guide-test-acceptance.html">Pruebas de aceptación</a>
<a class="list-group-item" href="./guide-test-fixtures.html">Fixtures</a></div>
<a class="list-group-item" href="#navigation-229" data-toggle="collapse" data-parent="#navigation">Temas especiales <b class="caret"></b></a><div id="navigation-229" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-tutorial-advanced-app.html">Plantilla aplicación avanzada</a>
<a class="list-group-item" href="./guide-tutorial-start-from-scratch.html">Creación de una aplicación desde cero</a>
<a class="list-group-item" href="./guide-tutorial-console.html">Comandos de consola</a>
<a class="list-group-item" href="./guide-tutorial-core-validators.html">Validadores del núcleo</a>
<a class="list-group-item" href="./guide-tutorial-i18n.html">Internacionalización</a>
<a class="list-group-item" href="./guide-tutorial-mailing.html">Envío de correos electrónicos</a>
<a class="list-group-item" href="./guide-tutorial-performance-tuning.html">Mejora del rendimiento</a>
<a class="list-group-item" href="./guide-tutorial-shared-hosting.html">Entorno de alojamiento compartido</a>
<a class="list-group-item" href="./guide-tutorial-template-engines.html">Motores de plantillas</a>
<a class="list-group-item" href="./guide-tutorial-yii-integration.html">Trabajar con Código de Terceros</a></div>
<a class="list-group-item" href="#navigation-230" data-toggle="collapse" data-parent="#navigation">Widgets <b class="caret"></b></a><div id="navigation-230" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/yiisoft/yii2-bootstrap/blob/master/docs/guide-es/README.md">Bootstrap Widgets</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-jui/blob/master/docs/guide-es/README.md">Jquery UI Widgets</a></div>
<a class="list-group-item" href="#navigation-231" data-toggle="collapse" data-parent="#navigation">Clases auxiliares <b class="caret"></b></a><div id="navigation-231" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-helper-overview.html">Información general</a>
<a class="list-group-item" href="./guide-helper-array.html">ArrayHelper</a>
<a class="list-group-item" href="./guide-helper-html.html">Html</a>
<a class="list-group-item" href="./guide-helper-url.html">Url</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>Contenedor de Inyección de Dependencias <span id="contenedor-de-inyeccion-de-dependencias"></span><a href="#contenedor-de-inyeccion-de-dependencias" class="hashlink">&para;</a></h1>
<div class="toc"><ol><li><a href="#dependency-injection">Inyección de Dependencias</a></li>
<li><a href="#registering-dependencies">Registro de dependencias</a></li>
<li><a href="#resolving-dependencies">Resolución de Dependencias</a></li>
<li><a href="#practical-usage">Uso Practico</a></li>
<li><a href="#when-to-register-dependencies">Cuando Registrar Dependencias</a></li>
<li><a href="#summary">Resumen</a></li></ol></div>
<p>Un contenedor de Inyección de Dependencias (ID), es un objeto que sabe como instancias y configurar objetos y sus 
objetos dependientes. El <a href="http://martinfowler.com/articles/injection.html">articulo de Martin</a> contiene una buena 
explicación de porque son útiles los contenedores de ID. A continuación explicaremos como usar el contenedor de ID que 
proporciona Yii.</p>
<h2>Inyección de Dependencias  <span id="dependency-injection"></span><a href="#dependency-injection" class="hashlink">&para;</a></h2><p>Yii proporciona la función de contenedor de ID mediante la clase <span class="broken-link">yii\di\Container</span>. Soporta los siguientes tipos 
de ID:</p>
<ul>
<li>Inyección de constructores;</li>
<li>Inyección de setters y propiedades;</li>
<li>Inyección de <a href="http://php.net/manual/es/language.types.callable.php">llamadas de retorno PHP</a>;</li>
</ul>
<h3>Inyección de Constructores  <span id="constructor-injection"></span><a href="#constructor-injection" class="hashlink">&para;</a></h3><p>El contenedor de ID soporta inyección de constructores con la ayuda de los indicios (hint) de tipo para los parámetros del 
constructor. Los indicios de tipo le proporcionan información al contenedor para saber cuáles son las clases o 
interfaces dependientes al usarse para crear un nuevo objeto. El contenedor intentara obtener las instancias de las 
clases o interfaces dependientes y las inyectará dentro del nuevo objeto mediante el constructor. Por ejemplo,</p>
<pre><code class="hljs php language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(Bar <span class="hljs-variable">$bar</span>)</span>
    </span>{
    }
}

<span class="hljs-variable">$foo</span> = <span class="hljs-variable">$container</span>-&gt;get(<span class="hljs-string">'Foo'</span>);
<span class="hljs-comment">// que es equivalente a:</span>
<span class="hljs-variable">$bar</span> = <span class="hljs-keyword">new</span> Bar;
<span class="hljs-variable">$foo</span> = <span class="hljs-keyword">new</span> Foo(<span class="hljs-variable">$bar</span>);
</code></pre>
<h3>Inyección de Setters y Propiedades  <span id="setter-and-property-injection"></span><a href="#setter-and-property-injection" class="hashlink">&para;</a></h3><p>La inyección de setters y propiedades se admite a través de <a href="guide-concept-configurations.html">configuraciones</a>. Cuando se 
registra una dependencia o se crea un nuevo objeto, se puede proporcionar una configuración que usará el contenedor 
para inyectar las dependencias a través de sus correspondientes setters y propiedades. Por ejemplo,</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Object</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Object</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$bar</span>;

    <span class="hljs-keyword">private</span> <span class="hljs-variable">$_qux</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getQux</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;_qux;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setQux</span><span class="hljs-params">(Qux <span class="hljs-variable">$qux</span>)</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;_qux = <span class="hljs-variable">$qux</span>;
    }
}

<span class="hljs-variable">$container</span>-&gt;get(<span class="hljs-string">'Foo'</span>, [], [
    <span class="hljs-string">'bar'</span> =&gt; <span class="hljs-variable">$container</span>-&gt;get(<span class="hljs-string">'Bar'</span>),
    <span class="hljs-string">'qux'</span> =&gt; <span class="hljs-variable">$container</span>-&gt;get(<span class="hljs-string">'Qux'</span>),
]);
</code></pre>
<h3>Inyección de Llamadas de retorno PHP  <span id="php-callable-injection"></span><a href="#php-callable-injection" class="hashlink">&para;</a></h3><p>En este caso, el contenedor usará una llamada de retorno PHP registrada para construir una nueva instancia de una 
clase. La llamada de retorno se responsabiliza de que dependencias debe inyectar al nuevo objeto creado. Por ejemplo,</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'Foo'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Foo(<span class="hljs-keyword">new</span> Bar);
});

<span class="hljs-variable">$foo</span> = <span class="hljs-variable">$container</span>-&gt;get(<span class="hljs-string">'Foo'</span>);
</code></pre>
<h2>Registro de dependencias  <span id="registering-dependencies"></span><a href="#registering-dependencies" class="hashlink">&para;</a></h2><p>Se puede usar <span class="broken-link">yii\di\Container::set()</span> para registrar dependencias. El registro requiere un nombre de dependencia 
así como una definición de dependencia. Un nombre de dependencia puede ser un nombre de clase, un nombre de interfaz, 
o un nombre de alias; y una definición de dependencia puede ser un nombre de clase, un array de configuración, o una 
llamada de retorno PHP.</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$container</span> = <span class="hljs-keyword">new</span> \yii\di\Container;

<span class="hljs-comment">// registra un nombre de clase como tal. Puede se omitido.</span>
<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'yii\db\Connection'</span>);

<span class="hljs-comment">// registra una interfaz</span>
<span class="hljs-comment">// Cuando una clase depende de una interfaz, la clase correspondiente</span>
<span class="hljs-comment">// se instanciará como un objeto dependiente</span>
<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'yii\mail\MailInterface'</span>, <span class="hljs-string">'yii\swiftmailer\Mailer'</span>);

<span class="hljs-comment">// registra un nombre de alias. Se puede usar $container-&gt;get('foo')</span>
<span class="hljs-comment">// para crear una instancia de Connection</span>
<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'foo'</span>, <span class="hljs-string">'yii\db\Connection'</span>);

<span class="hljs-comment">// registrar una clase con configuración. La configuración</span>
<span class="hljs-comment">// se aplicara cuando la clase se instancie por get()</span>
<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'yii\db\Connection'</span>, [
    <span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'mysql:host=127.0.0.1;dbname=demo'</span>,
    <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'root'</span>,
    <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,
    <span class="hljs-string">'charset'</span> =&gt; <span class="hljs-string">'utf8'</span>,
]);

<span class="hljs-comment">// registra un nombre de alias con configuración de clase</span>
<span class="hljs-comment">// En este caso, se requiere un elemento "clase" para especificar la clase</span>
<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'db'</span>, [
    <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\db\Connection'</span>,
    <span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'mysql:host=127.0.0.1;dbname=demo'</span>,
    <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'root'</span>,
    <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,
    <span class="hljs-string">'charset'</span> =&gt; <span class="hljs-string">'utf8'</span>,
]);

<span class="hljs-comment">// registra una llamada de retorno de PHP</span>
<span class="hljs-comment">// La llamada de retorno sera ejecutada cada vez que se ejecute $container-&gt;get('db') </span>
<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'db'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$container</span>, <span class="hljs-variable">$params</span>, <span class="hljs-variable">$config</span>)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> \yii\db\Connection(<span class="hljs-variable">$config</span>);
});

<span class="hljs-comment">// registra un componente instancia</span>
<span class="hljs-comment">// $container-&gt;get('pageCache') devolverá la misma instancia cada vez que se ejecute</span>
<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'pageCache'</span>, <span class="hljs-keyword">new</span> FileCache);
</code></pre>
<blockquote class="tip"><p><strong>Tip: </strong>Si un nombre de dependencia es el mismo que la definición de dependencia, no es necesario registrarlo con 
  el contenedor de ID.</p>
</blockquote>
<p>Una dependencia registrada mediante <code>set()</code> generará una instancia cada vez que se necesite la dependencia. Se puede 
usar <span class="broken-link">yii\di\Container::setSingleton()</span> para registrar una dependencia que genere una única instancia:</p>
<pre><code class="hljs php language-php"><span class="hljs-variable">$container</span>-&gt;setSingleton(<span class="hljs-string">'yii\db\Connection'</span>, [
    <span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'mysql:host=127.0.0.1;dbname=demo'</span>,
    <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'root'</span>,
    <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,
    <span class="hljs-string">'charset'</span> =&gt; <span class="hljs-string">'utf8'</span>,
]);
</code></pre>
<h2>Resolución de Dependencias  <span id="resolving-dependencies"></span><a href="#resolving-dependencies" class="hashlink">&para;</a></h2><p>Una ves se hayan registrado las dependencias, se puede usar el contenedor de ID para crear nuevos objetos, y el 
contenedor resolverá automáticamente las dependencias instanciándolas e inyectándolas dentro de los nuevos objetos 
creados. La resolución de dependencias es recursiva, esto significa que si una dependencia tiene otras dependencias, 
estas dependencias también se resolverán automáticamente.</p>
<p>Se puede usar <span class="broken-link">yii\di\Container::get()</span> para crear nuevos objetos. El método obtiene el nombre de dependencia, que 
puede ser un nombre de clase, un nombre de interfaz o un nombre de alias. El nombre de dependencia puede estar 
registrado o no mediante <code>set()</code> o <code>setSingleton()</code>. Se puede proporcionar opcionalmente un listado de los parámetros 
del constructor de clase y una <a href="guide-concept-configurations.html">configuración</a> para configurar los nuevos objetos creados. 
Por ejemplo,</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// "db" ha sido registrado anteriormente como nombre de alias</span>
<span class="hljs-variable">$db</span> = <span class="hljs-variable">$container</span>-&gt;get(<span class="hljs-string">'db'</span>);

<span class="hljs-comment">// equivalente a: $engine = new \app\components\SearchEngine($apiKey, ['type' =&gt; 1]);</span>
<span class="hljs-variable">$engine</span> = <span class="hljs-variable">$container</span>-&gt;get(<span class="hljs-string">'app\components\SearchEngine'</span>, [<span class="hljs-variable">$apiKey</span>], [<span class="hljs-string">'type'</span> =&gt; <span class="hljs-number">1</span>]);
</code></pre>
<p>Por detrás, el contenedor de ID efectúa mucho más trabajo la creación de un nuevo objeto. El contenedor primero 
inspeccionará la clase constructora para encontrar los nombres de clase o interfaces dependientes y después 
automáticamente resolverá estas dependencias recursivamente.</p>
<p>El siguiente código muestra un ejemplo más sofisticado. La clase <code>UserLister</code> depende del un objeto que implementa la 
interfaz <code>UserFinderInterface</code>; la clase <code>UserFinder</code> implementa la interfaz y depende del objeto <code>Connection</code>.  Todas 
estas dependencias se declaran a través de insinuaciones (hinting) de los parámetros del constructor de clase. Con el 
registro de dependencia de propiedades, el contenedor de ID puede resolver las dependencias automáticamente y crear 
una nueva instancia de <code>UserLister</code> con una simple llamada a <code>get('userLister')</code>.</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">models</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Object</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">db</span>\<span class="hljs-title">Connection</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">di</span>\<span class="hljs-title">Container</span>;

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserFinderInterface</span>
</span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findUser</span><span class="hljs-params">()</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserFinder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Object</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserFinderInterface</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$db</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(Connection <span class="hljs-variable">$db</span>, <span class="hljs-variable">$config</span> = [])</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;db = <span class="hljs-variable">$db</span>;
        <span class="hljs-keyword">parent</span>::__construct(<span class="hljs-variable">$config</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findUser</span><span class="hljs-params">()</span>
    </span>{
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserLister</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Object</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$finder</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(UserFinderInterface <span class="hljs-variable">$finder</span>, <span class="hljs-variable">$config</span> = [])</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;finder = <span class="hljs-variable">$finder</span>;
        <span class="hljs-keyword">parent</span>::__construct(<span class="hljs-variable">$config</span>);
    }
}

<span class="hljs-variable">$container</span> = <span class="hljs-keyword">new</span> Container;
<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'yii\db\Connection'</span>, [
    <span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'...'</span>,
]);
<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'app\models\UserFinderInterface'</span>, [
    <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'app\models\UserFinder'</span>,
]);
<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'userLister'</span>, <span class="hljs-string">'app\models\UserLister'</span>);

<span class="hljs-variable">$lister</span> = <span class="hljs-variable">$container</span>-&gt;get(<span class="hljs-string">'userLister'</span>);

<span class="hljs-comment">// que es equivalente a:</span>

<span class="hljs-variable">$db</span> = <span class="hljs-keyword">new</span> \yii\db\Connection([<span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'...'</span>]);
<span class="hljs-variable">$finder</span> = <span class="hljs-keyword">new</span> UserFinder(<span class="hljs-variable">$db</span>);
<span class="hljs-variable">$lister</span> = <span class="hljs-keyword">new</span> UserLister(<span class="hljs-variable">$finder</span>);
</code></pre>
<h2>Uso Practico  <span id="practical-usage"></span><a href="#practical-usage" class="hashlink">&para;</a></h2><p>Yii crea un contenedor de ID cuando se incluye el archivo <code>Yii.php</code> en el 
<a href="guide-structure-entry-scripts.html">script de entrada</a> de la aplicación. Cuando se llama a <span class="broken-link">Yii::createObject()</span> el método 
realmente llama al contenedor del método <span class="broken-link">yii\di\Container::get()</span> para crear un nuevo objeto. Como se ha 
comentado anteriormente, el contenedor de ID resolverá automáticamente las dependencias (si las hay) y las inyectará 
dentro del nuevo objeto creado. Debido a que Yii utiliza <span class="broken-link">Yii::createObject()</span> en la mayor parte del núcleo (core) 
para crear nuevo objetos, podemos personalizar los objetos globalmente para que puedan tratar con <span class="broken-link">Yii::$container</span>.</p>
<p>Por ejemplo, se puede personalizar globalmenete el numero predeterminado de números de botones de paginación de 
<span class="broken-link">yii\widgets\LinkPager</span>:</p>
<pre><code class="hljs php language-php">\Yii::<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'yii\widgets\LinkPager'</span>, [<span class="hljs-string">'maxButtonCount'</span> =&gt; <span class="hljs-number">5</span>]);
</code></pre>
<p>Ahora si se usa el widget en una vista con el siguiente código, la propiedad <code>maxButtonCount</code> será inicializada con 
valor 5 en lugar de 10 que es el valor predeterminado definido en la clase.</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">echo</span> \yii\widgets\LinkPager::widget();
</code></pre>
<p>Se puede sobrescribir el valor establecido mediante el contenedor de ID, como a continuación:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">echo</span> \yii\widgets\LinkPager::widget([<span class="hljs-string">'maxButtonCount'</span> =&gt; <span class="hljs-number">20</span>]);
</code></pre>
<p>Otro ejemplo es aprovechar la ventaja de la inyección automática de constructores de contenedores de ID. Asumiendo que 
la clase controlador depende de otros objetos, tales como un servicio de reservas de hotel. Se puede declarar una 
dependencia a través de un parámetro del constructor y permitir al contenedor de ID resolverla por nosotros.</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">controllers</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">web</span>\<span class="hljs-title">Controller</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">components</span>\<span class="hljs-title">BookingInterface</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HotelController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$bookingService</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(<span class="hljs-variable">$id</span>, <span class="hljs-variable">$module</span>, BookingInterface <span class="hljs-variable">$bookingService</span>, <span class="hljs-variable">$config</span> = [])</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;bookingService = <span class="hljs-variable">$bookingService</span>;
        <span class="hljs-keyword">parent</span>::__construct(<span class="hljs-variable">$id</span>, <span class="hljs-variable">$module</span>, <span class="hljs-variable">$config</span>);
    }
}
</code></pre>
<p>Si se accede al controlador desde el navegador, veremos un error advirtiendo que <code>BookingInterface</code> no puede ser 
instanciada. Esto se debe a que necesitamos indicar al contenedor de ID como tratar con esta dependencia:</p>
<pre><code class="hljs php language-php">\Yii::<span class="hljs-variable">$container</span>-&gt;set(<span class="hljs-string">'app\components\BookingInterface'</span>, <span class="hljs-string">'app\components\BookingService'</span>);
</code></pre>
<p>Ahora si se accede al contenedor nuevamente, se creará una instancia de <code>app\components\BookingService</code> y se inyectará 
a como tercer parámetro al constructor del controlador.</p>
<h2>Cuando Registrar Dependencias  <span id="when-to-register-dependencies"></span><a href="#when-to-register-dependencies" class="hashlink">&para;</a></h2><p>El registro de dependencias debe hacerse lo antes posible debido a que las dependencias se necesitan cuando se crean 
nuevos objetos. A continuación se listan practicas recomendadas:</p>
<ul>
<li>Siendo desarrolladores de una aplicación, podemos registrar dependencias en el 
<a href="guide-structure-entry-scripts.html">script de entrada</a> o en un script incluido en el script de entrada.</li>
<li>Siendo desarrolladores de una <a href="guide-structure-extensions.html">extension</a> redistribuible, podemos registrar dependencias en 
la clase de boostraping de la extensión.</li>
</ul>
<h2>Resumen  <span id="summary"></span><a href="#summary" class="hashlink">&para;</a></h2><p>Tanto la inyección de dependencias como el <a href="guide-concept-service-locator.html">localizador de servicios</a> son patrones de 
diseño populares que permiten construir software con acoplamiento flexible y más fácil de testear. Se recomienda 
encarecida la lectura del articulo de <a href="http://martinfowler.com/articles/injection.html">Martin</a> para obtener una mejor 
comprensión de la inyección de dependencias y de la localización de servicios.</p>
<p>Yii implementa su propio <a href="guide-concept-service-locator.html">localizador de servicios</a> por encima del contenedor de ID. 
Cuando un localizador de servicios intenta crear una nueva instancia de objeto, se desviará la llamada al contenedor 
de ID. Este último resolverá las dependencias automáticamente como se ha descrito anteriormente.</p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Wed, 22 Mar 2017 18:28:18 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) setTimeout(shiftWindow, 1);
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
